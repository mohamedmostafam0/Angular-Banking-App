<div class="marketplace-widget-container">
  <!-- Existing Carousel from marketplace.component.html -->
  <p-carousel
    [value]="utilities"
    [numVisible]="3"
    [numScroll]="1"
    [responsiveOptions]="responsiveOptions"
  >
    <ng-template let-utility pTemplate="item">
      <div class="utility-item" (click)="selectUtility(utility)">
        <div class="utility-item-content">
          <div class="p-mb-3 text-center">
            <img
              *ngIf="utility.logo"
              [src]="utility.logo"
              [alt]="utility.name"
              class="product-image"
            />
            <i
              *ngIf="!utility.logo"
              [class]="'pi ' + utility.icon"
              style="font-size: 3rem"
            ></i>
          </div>
          <div class="text-center">
            <h4 class="p-mb-1">{{ utility.name }}</h4>
          </div>
        </div>
      </div>
    </ng-template>
  </p-carousel>

  <!-- Existing Bill Payment Dialog from marketplace.component.html -->
  <p-dialog
    header="Pay {{ selectedUtility?.name }} Bill"
    [(visible)]="showDialog"
    [modal]="true"
    [style]="{ width: '450px' }"
    [draggable]="false"
    [resizable]="false"
  >
    <div class="p-fluid">
      <div class="p-field">
        <label for="amount">Amount to Pay</label>
        <p-inputNumber
          id="amount"
          [(ngModel)]="billAmount"
          mode="currency"
          currency="USD"
          locale="en-US"
          [disabled]="true"
        ></p-inputNumber>
      </div>
      <div class="p-field">
        <label for="account">Pay with Account</label>
        <p-dropdown
          id="account"
          [(ngModel)]="selectedAccount"
          [options]="accounts"
          placeholder="Select an account"
          optionLabel="number"
          [showClear]="true"
        >
          <ng-template let-account pTemplate="selectedItem">
            <div class="selected-account" *ngIf="account">
              <span>{{ account.number }}</span>
            </div>
          </ng-template>
          <ng-template let-account pTemplate="item">
            <div class="account-option">
              <div class="account-info">
                <i class="pi pi-credit-card" style="margin-right: 0.5rem"></i>
                <div>
                  <div class="account-number">{{ account.number }}</div>
                  <div class="account-balance">
                    Balance:
                    {{ formatCurrency(account.balance, account.currency) }}
                  </div>
                </div>
              </div>
            </div>
          </ng-template>
        </p-dropdown>
      </div>
    </div>
    <ng-template pTemplate="footer">
      <button
        pButton
        type="button"
        label="Confirm Payment"
        (click)="payBill()"
        [disabled]="!selectedAccount"
        appendTo="body"
      ></button>
    </ng-template>
  </p-dialog>

  <!-- "List Your Item" Form -->
  <form
    [formGroup]="marketplaceForm"
    (ngSubmit)="onSubmit()"
    class="p-fluid marketplace-form"
  ></form>
</div>
